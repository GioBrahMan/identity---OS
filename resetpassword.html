<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Reset Password — Identity OS</title>


  <meta http-equiv="Referrer-Policy" content="no-referrer" />
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="Permissions-Policy" content="
    camera=(),
    microphone=(),
    geolocation=(),
    payment=(),
    usb=(),
    interest-cohort=()
  " />


  <!-- Hygiene meta (real CSP in /_headers) -->
  <!-- External CSS only (CSP-friendly) -->
  <link rel="stylesheet" href="./resetpassword.css" />
</head>

<body>
  <main class="shell">
    <section class="card" aria-labelledby="title">
      <header class="header">
        <h1 id="title">Set a new password</h1>
        <p class="sub">
          Open this page using the reset link from your email. Then choose a strong new password.
        </p>
      </header>

      <!-- Shown when token is missing/expired -->
      <div id="tokenError" class="errorBox hidden" role="alert" aria-live="assertive"></div>

      <!-- Hidden until session is established (your resetpassword.js controls this) -->
      <form id="resetForm" class="hidden" autocomplete="on" novalidate>
        <div class="field">
          <label for="newPass">New password</label>
          <input
            id="newPass"
            name="newPass"
            type="password"
            autocomplete="new-password"
            placeholder="New password"
            required
            minlength="10"
          />
        </div>

        <div class="field">
          <label for="confirmPass">Confirm password</label>
          <input
            id="confirmPass"
            name="confirmPass"
            type="password"
            autocomplete="new-password"
            placeholder="Confirm password"
            required
            minlength="10"
          />
        </div>

        <div class="req" id="reqList" aria-live="polite"></div>

        <div class="barWrap" aria-hidden="true">
          <div id="strengthBar"></div>
        </div>

        <div class="btnRow">
          <button id="btnUpdate" type="submit" disabled>Update Password</button>
          <a class="btnGhost" href="./LoginPage.html">Back to login</a>
        </div>

        <p id="msg" class="msg hidden" role="status" aria-live="polite"></p>

        <p class="footnote">
          Link expired? <a class="link" href="./LoginPage.html">Go back to login and request a new reset link</a>
        </p>
      </form>
    </section>
  </main>

  <!-- ✅ External JS only -->
  <script type="module" src="./resetpassword.js"></script>
</body>
</html>
